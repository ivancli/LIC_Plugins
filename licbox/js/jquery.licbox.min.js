/**
 * Created by Ivan on 24/12/13.
 * licbox version 1.1
 */
"use strict";(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e){var t={width:200,height:200,margin_left:-100,margin_top:-100,animation_velocity:500,before_show:null,before_hide:null,after_show:null,after_hide:null,auto_show:true,animation:true,show_close_button:true,show_move_button:false,backdrop:true,main_container:null,backdrop_container:null,close_button_container:null,move_button_container:null,close_button_structure:'<a href="#" class="btn-close"></a>',move_button_structure:'<span class="btn-move"></span>',backdrop_structure:'<div class="licbox-backdrop"></div>',settings:null,mousedown_x:null,mousedown_y:null,origin_offset_x:null,origin_offset_y:null,is_mousedown:false};e.fn.licbox=function(n,r){return this.each(function(){var i=e.extend(true,{},t);var s=e(this);if(typeof n==="object"){e.extend(true,i,n)}else{r=n}i.main_container=s;var o=function(){if(!i.main_container.hasClass("licbox")){i.main_container.addClass("licbox")}i.main_container.hide();if(i.show_close_button){i.close_button_container=e(i.close_button_structure);i.main_container.append(i.close_button_container);i.close_button_container.click(function(){a()})}i.margin_left=-(i.width/2);i.margin_top=-(i.height/2);i.main_container.css({width:i.width,height:i.height,"margin-left":i.margin_left,"margin-top":i.margin_top});s.data("licbox",s);s.data("licbox-show",u);s.data("licbox-hide",a);s.data("licbox-toggle",f);if(i.show_move_button){i.move_button_container=e(i.move_button_structure);i.main_container.append(i.move_button_container);i.move_button_container.mousedown(function(e){i.is_mousedown=true;i.mousedown_x=e.clientX;i.mousedown_y=e.clientY;i.origin_offset_x=i.main_container.offset().left;i.origin_offset_y=i.main_container.offset().top;i.main_container.css("opacity","0.5")});e("body").mousemove(function(e){if(i.is_mousedown){var t=i.origin_offset_x-(i.mousedown_x-e.clientX)-i.margin_left;var n=i.origin_offset_y-(i.mousedown_y-e.clientY)-i.margin_top;i.main_container.css({left:t+"px",top:n+"px"})}});e("body").mouseup(function(e){i.is_mousedown=false;i.main_container.css("opacity","1")})}if(i.auto_show){u()}};var u=function(){if(e.isFunction(i.before_show)){i.before_show()}if(i.backdrop){l()}else{c()}if(i.animation){i.main_container.fadeIn(i.animation_velocity)}else{i.main_container.show()}if(e.isFunction(i.after_show)){i.after_show()}};var a=function(){if(e.isFunction(i.before_hide)){i.before_hide()}if(i.animation){i.main_container.fadeOut(i.animation_velocity)}else{i.main_container.hide()}c();if(e.isFunction(i.after_hide)){i.after_hide()}};var f=function(){if(s.is(":visible")){a()}else{u()}};var l=function(){i.backdrop_container=e(i.backdrop_structure);e("body").append(i.backdrop_container);if(i.animation){i.backdrop_container.fadeIn(i.animation_velocity)}else{i.backdrop_container.show()}};var c=function(){if(i.animation){i.backdrop_container.fadeOut(i.animation_velocity,function(){e(this).remove()})}else{i.backdrop_container.remove()}};if(r==="show"){if(s.data("licbox-show")&&!s.is(":visible")){s.data("licbox-show")()}return s}else if(r==="hide"){if(s.data("licbox-hide")&&s.is(":visible")){s.data("licbox-hide")()}return s}else if(r==="toggle"){if(s.data("licbox-toggle")){s.data("licbox-toggle")()}return s}if(s.data("licbox")){return s.data("licbox")}o();return s})}})